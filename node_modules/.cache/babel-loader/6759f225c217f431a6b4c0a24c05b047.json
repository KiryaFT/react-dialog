{"ast":null,"code":"import dayjs from 'dayjs';\nexport const normalizeDialog = dialog => {\n  const newDialog = [];\n  dialog.forEach((item, i) => {\n    if (i === 0 || dialog[i - 1]) {\n      const first = dayjs((i === 0 ? item : dialog[i - 1]).date);\n      const diff = first.diff(item.date, 'day');\n\n      if (i === 0 || diff) {\n        newDialog.push({\n          type: 'title',\n          id: `item-title-${item.id}`,\n          date: item.date\n        });\n      }\n    }\n\n    if (i === 0 || item.is !== dialog[i - 1].is) {\n      newDialog.push({\n        type: 'message',\n        id: `item-message-${item.id}`,\n        avatar: item.avatar,\n        isReverse: item.is === 'my',\n        isRemovable: item.is === 'my',\n        messages: [{\n          text: item.message,\n          status: item.status,\n          id: item.id,\n          date: item.date\n        }]\n      });\n    } else {\n      const position = newDialog.length - 1;\n      newDialog[position] = { ...newDialog[position],\n        messages: newDialog[position].messages.concat({\n          text: item.message,\n          status: item.status,\n          id: item.id,\n          date: item.date\n        })\n      };\n    }\n  });\n  return newDialog;\n};","map":{"version":3,"sources":["C:/Users/Пользователь/react-dialog-example/src/components/Dialog/helpers.js"],"names":["dayjs","normalizeDialog","dialog","newDialog","forEach","item","i","first","date","diff","push","type","id","is","avatar","isReverse","isRemovable","messages","text","message","status","position","length","concat"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,eAAe,GAAIC,MAAD,IAAY;AACvC,QAAMC,SAAS,GAAG,EAAlB;AAEAD,EAAAA,MAAM,CAACE,OAAP,CAAe,CAACC,IAAD,EAAOC,CAAP,KAAa;AACxB,QAAIA,CAAC,KAAK,CAAN,IAAWJ,MAAM,CAACI,CAAC,GAAG,CAAL,CAArB,EAA8B;AAC1B,YAAMC,KAAK,GAAGP,KAAK,CAAC,CAACM,CAAC,KAAK,CAAN,GAAUD,IAAV,GAAiBH,MAAM,CAACI,CAAC,GAAG,CAAL,CAAxB,EAAiCE,IAAlC,CAAnB;AACA,YAAMC,IAAI,GAAGF,KAAK,CAACE,IAAN,CAAWJ,IAAI,CAACG,IAAhB,EAAsB,KAAtB,CAAb;;AAEA,UAAIF,CAAC,KAAK,CAAN,IAAWG,IAAf,EAAqB;AACjBN,QAAAA,SAAS,CAACO,IAAV,CAAe;AACXC,UAAAA,IAAI,EAAE,OADK;AAEXC,UAAAA,EAAE,EAAG,cAAaP,IAAI,CAACO,EAAG,EAFf;AAGXJ,UAAAA,IAAI,EAAEH,IAAI,CAACG;AAHA,SAAf;AAKH;AACJ;;AAED,QAAIF,CAAC,KAAK,CAAN,IAAWD,IAAI,CAACQ,EAAL,KAAYX,MAAM,CAACI,CAAC,GAAG,CAAL,CAAN,CAAcO,EAAzC,EAA6C;AACzCV,MAAAA,SAAS,CAACO,IAAV,CAAe;AACXC,QAAAA,IAAI,EAAE,SADK;AAEXC,QAAAA,EAAE,EAAG,gBAAeP,IAAI,CAACO,EAAG,EAFjB;AAGXE,QAAAA,MAAM,EAAET,IAAI,CAACS,MAHF;AAIXC,QAAAA,SAAS,EAAEV,IAAI,CAACQ,EAAL,KAAY,IAJZ;AAKXG,QAAAA,WAAW,EAAEX,IAAI,CAACQ,EAAL,KAAY,IALd;AAMXI,QAAAA,QAAQ,EAAE,CACN;AACIC,UAAAA,IAAI,EAAEb,IAAI,CAACc,OADf;AAEIC,UAAAA,MAAM,EAAEf,IAAI,CAACe,MAFjB;AAGIR,UAAAA,EAAE,EAAEP,IAAI,CAACO,EAHb;AAIIJ,UAAAA,IAAI,EAAEH,IAAI,CAACG;AAJf,SADM;AANC,OAAf;AAeH,KAhBD,MAgBO;AACH,YAAMa,QAAQ,GAAGlB,SAAS,CAACmB,MAAV,GAAmB,CAApC;AAEAnB,MAAAA,SAAS,CAACkB,QAAD,CAAT,GAAsB,EAClB,GAAGlB,SAAS,CAACkB,QAAD,CADM;AAElBJ,QAAAA,QAAQ,EAAEd,SAAS,CAACkB,QAAD,CAAT,CAAoBJ,QAApB,CAA6BM,MAA7B,CAAoC;AAC1CL,UAAAA,IAAI,EAAEb,IAAI,CAACc,OAD+B;AAE1CC,UAAAA,MAAM,EAAEf,IAAI,CAACe,MAF6B;AAG1CR,UAAAA,EAAE,EAAEP,IAAI,CAACO,EAHiC;AAI1CJ,UAAAA,IAAI,EAAEH,IAAI,CAACG;AAJ+B,SAApC;AAFQ,OAAtB;AASH;AACJ,GA3CD;AA6CA,SAAOL,SAAP;AACH,CAjDM","sourcesContent":["import dayjs from 'dayjs'\r\n\r\nexport const normalizeDialog = (dialog) => {\r\n    const newDialog = []\r\n\r\n    dialog.forEach((item, i) => {\r\n        if (i === 0 || dialog[i - 1]) {\r\n            const first = dayjs((i === 0 ? item : dialog[i - 1]).date)\r\n            const diff = first.diff(item.date, 'day')\r\n\r\n            if (i === 0 || diff) {\r\n                newDialog.push({\r\n                    type: 'title',\r\n                    id: `item-title-${item.id}`,\r\n                    date: item.date\r\n                })\r\n            }\r\n        }\r\n\r\n        if (i === 0 || item.is !== dialog[i - 1].is) {\r\n            newDialog.push({\r\n                type: 'message',\r\n                id: `item-message-${item.id}`,\r\n                avatar: item.avatar,\r\n                isReverse: item.is === 'my',\r\n                isRemovable: item.is === 'my',\r\n                messages: [\r\n                    {\r\n                        text: item.message,\r\n                        status: item.status,\r\n                        id: item.id,\r\n                        date: item.date,\r\n                    },\r\n                ],\r\n            })\r\n        } else {\r\n            const position = newDialog.length - 1\r\n\r\n            newDialog[position] = {\r\n                ...newDialog[position],\r\n                messages: newDialog[position].messages.concat({\r\n                    text: item.message,\r\n                    status: item.status,\r\n                    id: item.id,\r\n                    date: item.date,\r\n                }),\r\n            }\r\n        }\r\n    })\r\n\r\n    return newDialog\r\n}"]},"metadata":{},"sourceType":"module"}